import os
import pandas as pd

# 定義檔案夾路徑
folder_path = './file'  # 儲存 XLS 檔案的資料夾
output_folder = './converted_csv'  # 儲存 CSV 檔案的資料夾

# 確保輸出資料夾存在
if not os.path.exists(output_folder):
    os.makedirs(output_folder)

# 遍歷資料夾中的檔案
for file_name in os.listdir(folder_path):
    if file_name.endswith('.xls') or file_name.endswith('.xlsx'):  # 找到所有 XLS/XLSX 檔案
        # 讀取 XLS 檔案
        file_path = os.path.join(folder_path, file_name)
        try:
            data = pd.read_excel(file_path)  # 讀取 Excel 檔案
            # 儲存為 CSV
            csv_file_name = file_name.replace('.xls', '.csv').replace('.xlsx', '.csv')
            csv_file_path = os.path.join(output_folder, csv_file_name)
            data.to_csv(csv_file_path, index=False, encoding='utf-8-sig')  # 儲存為 CSV，使用 UTF-8 編碼
            print(f"成功將 {file_name} 轉換為 {csv_file_name}")
        except Exception as e:
            print(f"轉換 {file_name} 時發生錯誤：{e}")
